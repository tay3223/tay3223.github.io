(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{427:function(e,t,a){"use strict";a.r(t);var o=a(24),s=Object(o.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"k8s集群中node磁盘爆满如何处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s集群中node磁盘爆满如何处理"}},[e._v("#")]),e._v(" k8s集群中Node磁盘爆满如何处理")]),e._v(" "),a("h3",{attrs:{id:"移出node节点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#移出node节点"}},[e._v("#")]),e._v(" 移出Node节点")]),e._v(" "),a("ul",[a("li",[e._v("首先从k8s集群中把该Node节点封锁、然后驱逐该Node节点上承载的Pod")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("#获取节点列表\nkubectl get nodes\n\n#封锁node，不让调度，驱逐和排空pod\nkubectl drain 10.1.2.2 --delete-local-data --ignore-daemonsets --force   \n")])])]),a("blockquote",[a("ul",[a("li",[a("p",[a("code",[e._v("--delete-local-data")]),e._v("：即使pod使用了emptyDir也删除")])]),e._v(" "),a("li",[a("p",[a("code",[e._v("--ignore-daemonsets")]),e._v("：忽略DaemonSet创建的pod，以及其它强守护进程类型的pod，只驱逐业务pod（不知道描述的对不对，大致上是这个意思）")])]),e._v(" "),a("li",[a("p",[a("code",[e._v("--force")]),e._v("：不加force参数只会删除该NODE上由ReplicationController, ReplicaSet, DaemonSet,StatefulSet or Job创建的Pod，加了后还会删除’裸奔的pod’(没有绑定到任何replication controller)")])])])]),e._v(" "),a("h3",{attrs:{id:"重启node上的docker服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重启node上的docker服务"}},[e._v("#")]),e._v(" 重启Node上的docker服务")]),e._v(" "),a("ul",[a("li",[e._v("Node节点封锁成功、且上面的Pod也驱逐成功后，登录这台Node节点服务器上，执行如下命令")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ssh root@10.1.2.2\nsystemctl restart dockerd.service\nsystemctl status dockerd.service\n")])])]),a("ul",[a("li",[a("blockquote",[a("p",[e._v("重启完成后，磁盘中临时被占用的数据和缓存就会被释放，此时磁盘就恢复正常了")])])])]),e._v(" "),a("h3",{attrs:{id:"重新让node节点投产"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重新让node节点投产"}},[e._v("#")]),e._v(" 重新让Node节点投产")]),e._v(" "),a("ul",[a("li",[e._v("为Node解封允许k8s集群可以调度该Node")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("kubectl uncordon 10.1.2.2\n")])])])])}),[],!1,null,null,null);t.default=s.exports}}]);