(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{436:function(e,a,t){"use strict";t.r(a);var s=t(24),r=Object(s.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"k8s部署-worker节点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#k8s部署-worker节点"}},[e._v("#")]),e._v(" k8s部署（Worker节点）")]),e._v(" "),t("blockquote",[t("p",[e._v("作者平时也得工作和干活~，尽量在有空的时候不断的去更新该博客...")]),e._v(" "),t("p",[e._v("如果有相关问题或反馈，可以加作者微信（微信号：SPE3SRU3STAY）")])]),e._v(" "),t("h3",{attrs:{id:"三项准备工作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三项准备工作"}},[e._v("#")]),e._v(" 三项准备工作：")]),e._v(" "),t("ul",[t("li",[e._v("本机Hostname解析")]),e._v(" "),t("li",[e._v("关闭Swap分区")]),e._v(" "),t("li",[e._v("Docker Cgroup Driver的修改")])]),e._v(" "),t("h3",{attrs:{id:"本机hostname解析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#本机hostname解析"}},[e._v("#")]),e._v(" 本机Hostname解析")]),e._v(" "),t("p",[e._v("1.变更主机名（假定我们把"),t("code",[e._v("192.168.0.2")]),e._v("这台机器的主机名叫做"),t("code",[e._v("node-1")]),e._v("，现在修改主机名）")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("hostnamectl set-hostname node-1\n")])])]),t("p",[e._v("2.更改/etc/hostname")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('echo "node-1" > /etc/hostname\n')])])]),t("p",[e._v("3.更改/etc/hosts，在localhost后面追加主机名：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("127.0.0.1 localhost.localdomain localhost node-1\n")])])]),t("h3",{attrs:{id:"关闭swap分区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#关闭swap分区"}},[e._v("#")]),e._v(" 关闭Swap分区")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("swapoff  -a\nsed -ri 's/.*swap.*/#&/' /etc/fstab\n")])])]),t("h3",{attrs:{id:"修改docker基座的运行模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改docker基座的运行模式"}},[e._v("#")]),e._v(" 修改Docker基座的运行模式")]),e._v(" "),t("blockquote",[t("p",[e._v("假定您按照上一篇"),t("code",[e._v("准备工作的文章")]),e._v("中，调用我的远程脚本安装了Docker的基座服务，那么这一步您将什么都不用去做。")])]),e._v(" "),t("hr"),e._v(" "),t("h3",{attrs:{id:"把node节点加入到master节点所控制的集群中"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#把node节点加入到master节点所控制的集群中"}},[e._v("#")]),e._v(" 把Node节点加入到Master节点所控制的集群中")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubeadm join 192.168.0.1:6443 \\\n    --token abcdef.0123456789abcdef \\\n    --discovery-token-ca-cert-hash sha256:a4a55f63ce7fc12d8bef130e652b332228b064f31b6a3e043eb1fc63e1445824 \\\n    --node-name node-1\n")])])]),t("ul",[t("li",[t("code",[e._v("192.168.0.1:6443")]),e._v("：是Master节点的IP地址加上api的端口")]),e._v(" "),t("li",[t("code",[e._v("--token")]),e._v("：是Master节点安装好之后顺带生成的")]),e._v(" "),t("li",[t("code",[e._v("--discovery-token-ca-cert-hash")]),e._v("：也是Master节点安装好之后顺带生成的")]),e._v(" "),t("li",[t("code",[e._v("--node-name")]),e._v("：当前节点加入到k8s集群之后的名字")])]),e._v(" "),t("p",[e._v("上面这些对应的信息，都在Master节点部署成功后给出的提示中已经标明出来了：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('Your Kubernetes control-plane has initialized successfully!\n\nTo start using your cluster, you need to run the following as a regular user:\n\n  mkdir -p $HOME/.kube\n  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n  sudo chown $(id -u):$(id -g) $HOME/.kube/config\n\nAlternatively, if you are the root user, you can run:\n\n  export KUBECONFIG=/etc/kubernetes/admin.conf\n\nYou should now deploy a pod network to the cluster.\nRun "kubectl apply -f [podnetwork].yaml" with one of the options listed at:\n  https://kubernetes.io/docs/concepts/cluster-administration/addons/\n\nThen you can join any number of worker nodes by running the following on each as root:\n\n\n\n（此处就是Master节点给出的提示，用于后面Node节点加入本集群时的对应Token和秘钥）\n\nkubeadm join 192.168.0.1:6443 --token abcdef.0123456789abcdef \\\n\t--discovery-token-ca-cert-hash sha256:75b93879944f5e2055e97fff426a48a6fe5c0eb91de1739886fa5864d0b12bf6\n\n')])])]),t("blockquote",[t("p",[e._v("（到此为止，Worker节点就已经安装成功了）")])]),e._v(" "),t("p",[t("br"),t("br"),t("br")]),t("hr"),t("br"),t("br"),t("br"),t("p"),e._v(" "),t("h4",{attrs:{id:"帮助作者改进文档"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#帮助作者改进文档"}},[e._v("#")]),e._v(" 帮助作者改进文档")]),e._v(" "),t("p",[e._v("如果您喜欢这篇文档，想让它变得更好，您可以：")]),e._v(" "),t("ul",[t("li",[e._v("推荐这篇文档，让更多的人知道。")]),e._v(" "),t("li",[e._v("给作者反馈和建议："),t("em",[t("em",[t("a",{attrs:{href:"mailto:tianye3223@gmail.com"}},[e._v("tianye3223@gmail.com")])])])])]),e._v(" "),t("p",[t("br"),t("br"),t("br"),t("br"),t("br")])])}),[],!1,null,null,null);a.default=r.exports}}]);